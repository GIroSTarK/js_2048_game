{"version":3,"sources":["scripts/main.js"],"names":["isWon","mainButton","document","querySelector","startMessage","loseMessage","winMessage","gameScore","field","startGame","rows","cellsInRow","score","updateCell","cell","value","textContent","classList","add","remove","lost","updateVertical","i","column","j","getElementById","updateHorizontal","goUp","mergeCells","goDown","reverse","goLeft","goRight","row","clearedRow","clearRow","length","push","filter","generate2or4","randValue","Math","random","generateRandomCell","hasEmptyCells","found","randomRow","floor","randomCell","makeFieldCopy","map","fieldsEqual","fieldCopy","clearField","addEventListener","contains","e","key"],"mappings":"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","file":"main.9bb0a2e1.js","sourceRoot":"..\\src","sourcesContent":["'use strict';\n\nconst mainButton = document.querySelector('.button');\nconst startMessage = document.querySelector('.message-start');\nconst loseMessage = document.querySelector('.message-lose');\nconst winMessage = document.querySelector('.message-win');\nconst gameScore = document.querySelector('.game-score');\nconst field = [\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n];\nlet startGame = false;\nconst rows = 4;\nconst cellsInRow = 4;\nlet score = 0;\nlet isWon;\n\nmainButton.addEventListener('click', () => {\n  if (mainButton.classList.contains('start')) {\n    mainButton.classList.remove('start');\n    mainButton.classList.add('restart');\n    mainButton.textContent = 'Restart';\n    startMessage.classList.add('hidden');\n    isWon = false;\n    startGame = true;\n    generateRandomCell();\n    generateRandomCell();\n  } else {\n    mainButton.classList.remove('restart');\n    mainButton.classList.add('start');\n    mainButton.textContent = 'Start';\n    startMessage.classList.remove('hidden');\n    winMessage.classList.add('hidden');\n    loseMessage.classList.add('hidden');\n    clearField();\n    gameScore.textContent = '0';\n    startGame = false;\n  }\n});\n\ndocument.addEventListener('keydown', (e) => {\n  if (isWon || !startGame) {\n    return;\n  }\n\n  if (e.key === 'w' || e.key === 'ArrowUp') {\n    const fieldCopy = makeFieldCopy();\n\n    goUp();\n\n    if (!fieldsEqual(fieldCopy)) {\n      generateRandomCell();\n    }\n  }\n\n  if (e.key === 'a' || e.key === 'ArrowLeft') {\n    const fieldCopy = makeFieldCopy();\n\n    goLeft();\n\n    if (!fieldsEqual(fieldCopy)) {\n      generateRandomCell();\n    }\n  }\n\n  if (e.key === 'd' || e.key === 'ArrowRight') {\n    const fieldCopy = makeFieldCopy();\n\n    goRight();\n\n    if (!fieldsEqual(fieldCopy)) {\n      generateRandomCell();\n    }\n  }\n\n  if (e.key === 's' || e.key === 'ArrowDown') {\n    const fieldCopy = makeFieldCopy();\n\n    goDown();\n\n    if (!fieldsEqual(fieldCopy)) {\n      generateRandomCell();\n    }\n  }\n  gameScore.textContent = score;\n});\n\nfunction updateCell(cell, value) {\n  cell.textContent = '';\n  cell.classList.value = '';\n  cell.classList.add('field-cell');\n\n  if (value > 0) {\n    cell.textContent = value;\n    cell.classList.add(`field-cell--${value}`);\n  }\n\n  if (value === 2048) {\n    winMessage.classList.remove('hidden');\n    isWon = true;\n  }\n\n  if (lost()) {\n    loseMessage.classList.remove('hidden');\n  }\n}\n\nfunction updateVertical(i, column) {\n  for (let j = 0; j < rows; j++) {\n    field[j][i] = column[j];\n\n    const value = field[j][i];\n    const cell = document.getElementById(`${j}-${i}`);\n\n    updateCell(cell, value);\n  }\n}\n\nfunction updateHorizontal(i) {\n  for (let j = 0; j < cellsInRow; j++) {\n    const value = field[i][j];\n    const cell = document.getElementById(`${i}-${j}`);\n\n    updateCell(cell, value);\n  }\n}\n\nfunction goUp() {\n  for (let i = 0; i < cellsInRow; i++) {\n    let column = [field[0][i], field[1][i], field[2][i], field[3][i]];\n\n    column = mergeCells(column);\n    updateVertical(i, column);\n  }\n}\n\nfunction goDown() {\n  for (let i = 0; i < cellsInRow; i++) {\n    let column = [field[0][i], field[1][i], field[2][i], field[3][i]];\n\n    column.reverse();\n    column = mergeCells(column);\n    column.reverse();\n    updateVertical(i, column);\n  }\n}\n\nfunction goLeft() {\n  for (let i = 0; i < rows; i++) {\n    field[i] = mergeCells(field[i]);\n    updateHorizontal(i);\n  }\n}\n\nfunction goRight() {\n  for (let i = 0; i < rows; i++) {\n    field[i].reverse();\n    field[i] = mergeCells(field[i]);\n    field[i].reverse();\n    updateHorizontal(i);\n  }\n}\n\nfunction mergeCells(row) {\n  let clearedRow = clearRow(row);\n\n  for (let i = 1; i < clearedRow.length; i++) {\n    if (clearedRow[i - 1] === clearedRow[i]) {\n      clearedRow[i - 1] *= 2;\n      clearedRow[i] = 0;\n      score += clearedRow[i - 1];\n    }\n  }\n\n  clearedRow = clearRow(clearedRow);\n\n  while (clearedRow.length < cellsInRow) {\n    clearedRow.push(0);\n  }\n\n  return clearedRow;\n}\n\nfunction clearRow(row) {\n  return row.filter((cell) => cell > 0);\n}\n\nfunction generate2or4() {\n  const randValue = Math.random();\n\n  if (randValue <= 0.1) {\n    return 4;\n  } else {\n    return 2;\n  }\n}\n\nfunction generateRandomCell() {\n  if (!hasEmptyCells()) {\n    return;\n  }\n\n  let found = false;\n\n  while (!found) {\n    const randomRow = Math.floor(Math.random() * rows);\n    const randomCell = Math.floor(Math.random() * cellsInRow);\n\n    if (field[randomRow][randomCell] === 0) {\n      const value = generate2or4();\n\n      field[randomRow][randomCell] = value;\n\n      const cell = document.getElementById(`${randomRow}-${randomCell}`);\n\n      cell.textContent = value;\n      cell.classList.add(`field-cell--${value}`);\n      found = true;\n    }\n  }\n}\n\nfunction hasEmptyCells() {\n  for (const row of field) {\n    for (const cell of row) {\n      if (cell === 0) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction makeFieldCopy() {\n  return field.map((row) => [...row]);\n}\n\nfunction fieldsEqual(fieldCopy) {\n  for (let i = 0; i < rows; i++) {\n    for (let j = 0; j < cellsInRow; j++) {\n      if (field[i][j] !== fieldCopy[i][j]) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n\nfunction clearField() {\n  for (let i = 0; i < rows; i++) {\n    for (let j = 0; j < cellsInRow; j++) {\n      if (field[i][j] !== 0) {\n        field[i][j] = 0;\n      }\n    }\n    updateHorizontal(i);\n  }\n  score = 0;\n}\n\nfunction lost() {\n  if (hasEmptyCells()) {\n    return false;\n  }\n\n  for (let i = 0; i < rows; i++) {\n    for (let j = 0; j < rows; j++) {\n      if (field[i][j] === field[i][j + 1]) {\n        return false;\n      }\n    }\n  }\n\n  for (let i = 0; i < rows - 1; i++) {\n    for (let j = 0; j < rows; j++) {\n      if (field[i][j] === field[i + 1][j]) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n"]}